"use strict";(self.webpackChunkprofilebook_frontend=self.webpackChunkprofilebook_frontend||[]).push([[267],{1267:(F,l,r)=>{r.r(l),r.d(l,{MessagesComponent:()=>x});var c=r(177),d=r(2183),e=r(4438),m=r(4537);const g=n=>["/messages",n];function u(n,a){1&n&&(e.j41(0,"div",11)(1,"div",12)(2,"span",13),e.EFF(3,"Loading conversations..."),e.k0s()(),e.j41(4,"p",14),e.EFF(5,"Loading your conversations..."),e.k0s()())}function f(n,a){1&n&&(e.j41(0,"div",11),e.nrm(1,"i",15),e.j41(2,"h5",16),e.EFF(3,"No conversations yet"),e.k0s(),e.j41(4,"p",16),e.EFF(5,"Start a conversation by searching for users and sending them a message"),e.k0s(),e.j41(6,"a",17),e.nrm(7,"i",18),e.EFF(8,"Find People "),e.k0s()())}function p(n,a){if(1&n&&(e.j41(0,"span",34),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.unreadCount>99?"99+":t.unreadCount," ")}}function _(n,a){if(1&n&&(e.j41(0,"small",16),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit,s=e.XpG(2);e.R7$(),e.SpI(" ",s.formatMessageTime(t.lastMessage.timeStamp)," ")}}function v(n,a){1&n&&(e.j41(0,"span",37),e.EFF(1,"You:"),e.k0s())}function h(n,a){if(1&n&&(e.j41(0,"div",22)(1,"span",35),e.DNE(2,v,2,0,"span",36),e.EFF(3),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(),e.AVh("fw-bold",t.unreadCount>0)("text-muted",0===t.unreadCount),e.R7$(),e.Y8G("ngIf","You"===t.lastMessage.senderName),e.R7$(),e.SpI(" ",t.lastMessage.messageContent," ")}}function M(n,a){if(1&n&&(e.j41(0,"a",21)(1,"div",22)(2,"div",23),e.nrm(3,"img",24),e.DNE(4,p,2,1,"span",25),e.k0s(),e.j41(5,"div",26)(6,"div",27)(7,"h6",28),e.EFF(8),e.k0s(),e.DNE(9,_,2,1,"small",29),e.k0s(),e.j41(10,"p",30),e.EFF(11),e.k0s(),e.DNE(12,h,4,6,"div",31),e.k0s(),e.j41(13,"div",32),e.nrm(14,"i",33),e.k0s()()()),2&n){const t=a.$implicit,s=e.XpG(2);e.AVh("unread",t.unreadCount>0),e.Y8G("routerLink",e.eq3(9,g,t.userId)),e.R7$(3),e.Y8G("src",s.getUserAvatar(t),e.B4B),e.R7$(),e.Y8G("ngIf",t.unreadCount>0),e.R7$(4),e.JRh(t.userFullName),e.R7$(),e.Y8G("ngIf",t.lastMessage),e.R7$(2),e.JRh("@"+t.userName),e.R7$(),e.Y8G("ngIf",t.lastMessage)}}function b(n,a){if(1&n&&(e.j41(0,"div",19),e.DNE(1,M,15,11,"a",20),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.conversations)}}function C(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",38),e.nrm(1,"i",39),e.EFF(2),e.j41(3,"button",40),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.loadConversations())}),e.nrm(4,"i",41),e.EFF(5,"Retry "),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(2),e.SpI("",t.errorMessage," ")}}let x=(()=>{class n{constructor(t){this.messageService=t,this.conversations=[],this.isLoading=!1,this.errorMessage=""}ngOnInit(){this.loadConversations()}loadConversations(){this.isLoading=!0,this.errorMessage="",this.messageService.getConversations().subscribe({next:t=>{this.conversations=t,this.isLoading=!1},error:t=>{this.isLoading=!1,this.errorMessage="Failed to load conversations. Please try again.",console.error("Error loading conversations:",t)}})}getUserAvatar(t){return t.userProfileImage?t.userProfileImage:"https://via.placeholder.com/56x56/3b82f6/ffffff?text="+(t.userFullName?.charAt(0)||"U")}formatMessageTime(t){const s=new Date,o=new Date(t),i=Math.floor((s.getTime()-o.getTime())/6e4);return i<1?"now":i<60?`${i}m`:i<1440?`${Math.floor(i/60)}h`:i<10080?`${Math.floor(i/1440)}d`:o.toLocaleDateString()}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(m.b))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-messages"]],standalone:!0,features:[e.aNF],decls:13,vars:4,consts:[[1,"container","mt-4"],[1,"row","justify-content-center"],[1,"col-lg-8"],[1,"card","shadow-sm"],[1,"card-header","bg-primary","text-white"],[1,"mb-0"],[1,"fas","fa-envelope","me-2"],[1,"card-body","p-0"],["class","text-center py-5",4,"ngIf"],["class","list-group list-group-flush",4,"ngIf"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"fas","fa-comments","fa-4x","text-muted","mb-3"],[1,"text-muted"],["routerLink","/search",1,"btn","btn-primary"],[1,"fas","fa-search","me-2"],[1,"list-group","list-group-flush"],["class","list-group-item list-group-item-action conversation-item",3,"routerLink","unread",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action","conversation-item",3,"routerLink"],[1,"d-flex","align-items-center"],[1,"position-relative"],["width","56","height","56","alt","User avatar",1,"rounded-circle","me-3",3,"src"],["class","position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",4,"ngIf"],[1,"flex-grow-1","min-w-0"],[1,"d-flex","justify-content-between","align-items-start"],[1,"mb-1","text-truncate"],["class","text-muted",4,"ngIf"],[1,"mb-1","text-muted","small"],["class","d-flex align-items-center",4,"ngIf"],[1,"ms-2"],[1,"fas","fa-chevron-right","text-muted"],[1,"position-absolute","top-0","start-100","translate-middle","badge","rounded-pill","bg-danger"],[1,"text-truncate"],["class","me-1",4,"ngIf"],[1,"me-1"],[1,"alert","alert-danger","mt-3"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],[1,"fas","fa-retry","me-1"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),e.nrm(6,"i",6),e.EFF(7,"Messages "),e.k0s()(),e.j41(8,"div",7),e.DNE(9,u,6,0,"div",8)(10,f,9,0,"div",8)(11,b,2,1,"div",9),e.k0s()(),e.DNE(12,C,6,1,"div",10),e.k0s()()()),2&s&&(e.R7$(9),e.Y8G("ngIf",o.isLoading),e.R7$(),e.Y8G("ngIf",!o.isLoading&&0===o.conversations.length),e.R7$(),e.Y8G("ngIf",!o.isLoading&&o.conversations.length>0),e.R7$(),e.Y8G("ngIf",o.errorMessage))},dependencies:[c.MD,c.Sq,c.bT,d.iI,d.Wk],styles:[".conversation-item[_ngcontent-%COMP%]{padding:1rem;border:none;border-bottom:1px solid var(--border-color);transition:background-color .2s ease}.conversation-item[_ngcontent-%COMP%]:hover{background-color:var(--light-bg)}.conversation-item.unread[_ngcontent-%COMP%]{background-color:#3b82f60d;border-left:4px solid var(--primary-color)}.conversation-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.min-w-0[_ngcontent-%COMP%]{min-width:0}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.badge[_ngcontent-%COMP%]{font-size:.7rem;min-width:1.5rem;height:1.5rem;display:flex;align-items:center;justify-content:center}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:0 1rem}.conversation-item[_ngcontent-%COMP%]{padding:.75rem}.rounded-circle[_ngcontent-%COMP%]{width:48px!important;height:48px!important}}"]})}}return n})()}}]);