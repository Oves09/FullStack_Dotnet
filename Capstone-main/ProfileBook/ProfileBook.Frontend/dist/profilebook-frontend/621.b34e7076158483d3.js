"use strict";(self.webpackChunkprofilebook_frontend=self.webpackChunkprofilebook_frontend||[]).push([[621],{6621:(I,d,f)=>{f.r(d),f.d(d,{NotificationsComponent:()=>C});var l=f(177),t=f(4438),g=f(7473);function u(n,o){if(1&n){const i=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){t.eBV(i);const s=t.XpG();return t.Njj(s.markAllAsRead())}),t.nrm(1,"i",15),t.EFF(2,"Mark All Read "),t.k0s()}if(2&n){const i=t.XpG();t.Y8G("disabled",0===i.notifications.length||i.isLoading)}}function m(n,o){1&n&&(t.j41(0,"div",16)(1,"div",17)(2,"span",18),t.EFF(3,"Loading notifications..."),t.k0s()(),t.j41(4,"p",19),t.EFF(5,"Loading notifications..."),t.k0s()())}function _(n,o){1&n&&(t.j41(0,"span",33),t.EFF(1,"New"),t.k0s())}function p(n,o){if(1&n){const i=t.RV6();t.j41(0,"button",34),t.bIt("click",function(s){t.eBV(i);const a=t.XpG(),r=a.$implicit,c=a.index;return t.XpG(2).markAsRead(r,c),t.Njj(s.stopPropagation())}),t.nrm(1,"i",35),t.k0s()}}function h(n,o){if(1&n){const i=t.RV6();t.j41(0,"div",22),t.bIt("click",function(){const s=t.eBV(i),a=s.$implicit,r=s.index,c=t.XpG(2);return t.Njj(c.markAsRead(a,r))}),t.j41(1,"div",23)(2,"div",24)(3,"div",25),t.nrm(4,"i",26),t.j41(5,"h6",27),t.EFF(6),t.k0s(),t.DNE(7,_,2,0,"span",28),t.k0s(),t.j41(8,"p",29),t.EFF(9),t.k0s(),t.j41(10,"small",30),t.nrm(11,"i",31),t.EFF(12),t.k0s()(),t.DNE(13,p,2,0,"button",32),t.k0s()()}if(2&n){const i=o.$implicit,e=t.XpG(2);t.AVh("bg-light",!i.isRead),t.R7$(4),t.HbH(e.getNotificationIcon(i.type)),t.Y8G("ngClass",e.getNotificationIconClass(i.type)),t.R7$(2),t.JRh(i.title),t.R7$(),t.Y8G("ngIf",!i.isRead),t.R7$(2),t.JRh(i.message),t.R7$(3),t.SpI("",e.formatDate(i.createdAt)," "),t.R7$(),t.Y8G("ngIf",!i.isRead)}}function b(n,o){if(1&n&&(t.j41(0,"div",20),t.DNE(1,h,14,10,"div",21),t.k0s()),2&n){const i=t.XpG();t.R7$(),t.Y8G("ngForOf",i.notifications)}}function v(n,o){1&n&&(t.j41(0,"div",16),t.nrm(1,"i",36),t.j41(2,"h5",30),t.EFF(3,"No notifications"),t.k0s(),t.j41(4,"p",30),t.EFF(5,"You're all caught up! No new notifications to show."),t.k0s()())}function k(n,o){1&n&&t.nrm(0,"span",41)}function N(n,o){1&n&&t.nrm(0,"i",42)}function M(n,o){if(1&n){const i=t.RV6();t.j41(0,"div",37)(1,"button",38),t.bIt("click",function(){t.eBV(i);const s=t.XpG();return t.Njj(s.loadMoreNotifications())}),t.DNE(2,k,1,0,"span",39)(3,N,1,0,"i",40),t.EFF(4),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(),t.Y8G("disabled",i.isLoadingMore),t.R7$(),t.Y8G("ngIf",i.isLoadingMore),t.R7$(),t.Y8G("ngIf",!i.isLoadingMore),t.R7$(),t.SpI(" ",i.isLoadingMore?"Loading...":"Load More"," ")}}function x(n,o){if(1&n){const i=t.RV6();t.j41(0,"div",43),t.nrm(1,"i",44),t.EFF(2),t.j41(3,"button",45),t.bIt("click",function(){t.eBV(i);const s=t.XpG();return t.Njj(s.successMessage="")}),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(2),t.SpI("",i.successMessage," ")}}function R(n,o){if(1&n){const i=t.RV6();t.j41(0,"div",46),t.nrm(1,"i",47),t.EFF(2),t.j41(3,"button",45),t.bIt("click",function(){t.eBV(i);const s=t.XpG();return t.Njj(s.errorMessage="")}),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(2),t.SpI("",i.errorMessage," ")}}let C=(()=>{class n{constructor(i){this.notificationService=i,this.notifications=[],this.isLoading=!1,this.isLoadingMore=!1,this.successMessage="",this.errorMessage="",this.currentPage=1,this.pageSize=20,this.hasMoreNotifications=!0,this.subscriptions=[]}ngOnInit(){this.loadNotifications(),this.notificationService.refreshUnreadCount()}ngOnDestroy(){this.subscriptions.forEach(i=>i.unsubscribe())}loadNotifications(){this.isLoading=!0,this.errorMessage="";const i=this.notificationService.getNotifications(this.currentPage,this.pageSize).subscribe({next:e=>{this.notifications=e,this.hasMoreNotifications=e.length===this.pageSize,this.isLoading=!1},error:e=>{this.isLoading=!1,this.errorMessage="Failed to load notifications. Please try again.",console.error("Error loading notifications:",e)}});this.subscriptions.push(i)}loadMoreNotifications(){this.isLoadingMore=!0,this.currentPage++;const i=this.notificationService.getNotifications(this.currentPage,this.pageSize).subscribe({next:e=>{this.notifications=[...this.notifications,...e],this.hasMoreNotifications=e.length===this.pageSize,this.isLoadingMore=!1},error:e=>{this.isLoadingMore=!1,this.currentPage--,this.errorMessage="Failed to load more notifications. Please try again.",console.error("Error loading more notifications:",e)}});this.subscriptions.push(i)}markAsRead(i,e){if(i.isRead)return;const s=this.notificationService.markAsRead(i.notificationId).subscribe({next:()=>{this.notifications[e].isRead=!0,this.notificationService.refreshUnreadCount(),this.successMessage="Notification marked as read",setTimeout(()=>this.successMessage="",3e3)},error:a=>{this.errorMessage="Failed to mark notification as read",console.error("Error marking notification as read:",a)}});this.subscriptions.push(s)}markAllAsRead(){const i=this.notificationService.markAllAsRead().subscribe({next:()=>{this.notifications.forEach(e=>e.isRead=!0),this.notificationService.refreshUnreadCount(),this.successMessage="All notifications marked as read",setTimeout(()=>this.successMessage="",3e3)},error:e=>{this.errorMessage="Failed to mark all notifications as read",console.error("Error marking all notifications as read:",e)}});this.subscriptions.push(i)}hasUnreadNotifications(){return this.notifications.some(i=>!i.isRead)}getNotificationIcon(i){switch(i.toLowerCase()){case"success":return"fas fa-check-circle notification-icon";case"warning":return"fas fa-exclamation-triangle notification-icon";case"error":return"fas fa-times-circle notification-icon";case"info":return"fas fa-info-circle notification-icon";default:return"fas fa-bell notification-icon"}}getNotificationIconClass(i){switch(i.toLowerCase()){case"success":return"text-success";case"warning":return"text-warning";case"error":return"text-danger";case"info":return"text-info";default:return"text-primary"}}formatDate(i){const e=new Date,s=new Date(i),a=Math.floor((e.getTime()-s.getTime())/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const r=Math.floor(a/60);if(r<24)return`${r}h ago`;const c=Math.floor(r/24);return c<7?`${c}d ago`:s.toLocaleDateString()}static{this.\u0275fac=function(e){return new(e||n)(t.rXU(g.J))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-notifications"]],standalone:!0,features:[t.aNF],decls:16,vars:7,consts:[[1,"container","mt-4"],[1,"row","justify-content-center"],[1,"col-lg-8"],[1,"card","shadow-sm"],[1,"card-header","bg-primary","text-white","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[1,"fas","fa-bell","me-2"],["class","btn btn-light btn-sm",3,"disabled","click",4,"ngIf"],[1,"card-body","p-0"],["class","text-center py-5",4,"ngIf"],["class","list-group list-group-flush",4,"ngIf"],["class","text-center p-3",4,"ngIf"],["class","alert alert-success alert-dismissible fade show mt-3",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show mt-3",4,"ngIf"],[1,"btn","btn-light","btn-sm",3,"click","disabled"],[1,"fas","fa-check-double","me-1"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"list-group","list-group-flush"],["class","list-group-item list-group-item-action",3,"bg-light","click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action",3,"click"],[1,"d-flex","w-100","justify-content-between","align-items-start"],[1,"flex-grow-1"],[1,"d-flex","align-items-center","mb-1"],[3,"ngClass"],[1,"mb-0","ms-2"],["class","badge bg-primary ms-2",4,"ngIf"],[1,"mb-1","text-muted"],[1,"text-muted"],[1,"fas","fa-clock","me-1"],["class","btn btn-sm btn-outline-primary ms-2",3,"click",4,"ngIf"],[1,"badge","bg-primary","ms-2"],[1,"btn","btn-sm","btn-outline-primary","ms-2",3,"click"],[1,"fas","fa-check"],[1,"fas","fa-bell-slash","fa-4x","text-muted","mb-3"],[1,"text-center","p-3"],[1,"btn","btn-outline-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-chevron-down me-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-chevron-down","me-2"],[1,"alert","alert-success","alert-dismissible","fade","show","mt-3"],[1,"fas","fa-check-circle","me-2"],["type","button",1,"btn-close",3,"click"],[1,"alert","alert-danger","alert-dismissible","fade","show","mt-3"],[1,"fas","fa-exclamation-triangle","me-2"]],template:function(e,s){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.nrm(6,"i",6),t.EFF(7,"Notifications "),t.k0s(),t.DNE(8,u,3,1,"button",7),t.k0s(),t.j41(9,"div",8),t.DNE(10,m,6,0,"div",9)(11,b,2,1,"div",10)(12,v,6,0,"div",9)(13,M,5,4,"div",11),t.k0s()(),t.DNE(14,x,4,1,"div",12)(15,R,4,1,"div",13),t.k0s()()()),2&e&&(t.R7$(8),t.Y8G("ngIf",s.hasUnreadNotifications()),t.R7$(2),t.Y8G("ngIf",s.isLoading),t.R7$(),t.Y8G("ngIf",!s.isLoading&&s.notifications.length>0),t.R7$(),t.Y8G("ngIf",!s.isLoading&&0===s.notifications.length),t.R7$(),t.Y8G("ngIf",!s.isLoading&&s.notifications.length>0&&s.hasMoreNotifications),t.R7$(),t.Y8G("ngIf",s.successMessage),t.R7$(),t.Y8G("ngIf",s.errorMessage))},dependencies:[l.MD,l.YU,l.Sq,l.bT],styles:[".list-group-item[_ngcontent-%COMP%]{border-left:none;border-right:none;cursor:pointer;transition:background-color .2s ease}.list-group-item[_ngcontent-%COMP%]:hover{background-color:var(--bs-gray-100)!important}.list-group-item.bg-light[_ngcontent-%COMP%]{background-color:var(--bs-blue-50)!important;border-left:3px solid var(--bs-primary)}.notification-icon[_ngcontent-%COMP%]{width:20px;text-align:center}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:0 1rem}.card-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.1rem}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}}"]})}}return n})()}}]);