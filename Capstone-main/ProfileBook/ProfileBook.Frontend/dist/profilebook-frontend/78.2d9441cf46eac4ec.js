"use strict";(self.webpackChunkprofilebook_frontend=self.webpackChunkprofilebook_frontend||[]).push([[78],{78:(z,u,i)=>{i.r(u),i.d(u,{SearchComponent:()=>B});var p=i(177),c=i(4341),v=i(3888),h=i(9974),f=i(4360),_=i(3669);function x(r,o){return r===o}var R=i(5558),S=i(7673),e=i(4438),k=i(9885),j=i(356),y=i(2183);function I(r,o){if(1&r&&(e.j41(0,"span",23),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.JRh(t.users.length)}}function E(r,o){1&r&&(e.j41(0,"div",24)(1,"div",25)(2,"span",26),e.EFF(3,"Searching..."),e.k0s()(),e.j41(4,"p",27),e.EFF(5,"Searching users..."),e.k0s()())}function M(r,o){1&r&&(e.j41(0,"div",24),e.nrm(1,"i",28),e.j41(2,"h5",29),e.EFF(3,"No users found"),e.k0s(),e.j41(4,"p",29),e.EFF(5,"Try adjusting your search terms"),e.k0s()())}function C(r,o){if(1&r&&(e.j41(0,"p",46),e.EFF(1),e.nI1(2,"slice"),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Lme(" ",e.brH(2,2,t.bio,0,100),"",t.bio.length>100?"...":""," ")}}function G(r,o){if(1&r&&(e.j41(0,"span",49),e.EFF(1),e.k0s()),2&r){const t=o.$implicit;e.R7$(),e.SpI(" ",t," ")}}function $(r,o){if(1&r&&(e.j41(0,"div",47),e.DNE(1,G,2,1,"span",48),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngForOf",t.roles)}}function T(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",32)(1,"div",33)(2,"div",4)(3,"div",34),e.nrm(4,"img",35),e.j41(5,"div",36)(6,"h6",37),e.EFF(7),e.k0s(),e.j41(8,"p",38),e.EFF(9),e.k0s(),e.j41(10,"small",29),e.EFF(11),e.k0s()()(),e.DNE(12,C,3,6,"p",39)(13,$,2,1,"div",40),e.j41(14,"div",41)(15,"button",42),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.sendMessage(n.id))}),e.nrm(16,"i",43),e.EFF(17,"Message "),e.k0s(),e.j41(18,"button",44),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.openReportModal(n))}),e.nrm(19,"i",45),e.EFF(20,"Report "),e.k0s()()()()()}if(2&r){const t=o.$implicit,s=e.XpG(3);e.R7$(4),e.Y8G("src",s.getUserAvatar(t),e.B4B),e.R7$(3),e.Lme("",t.firstName," ",t.lastName,""),e.R7$(2),e.JRh("@"+t.userName),e.R7$(2),e.JRh(t.email),e.R7$(),e.Y8G("ngIf",t.bio),e.R7$(),e.Y8G("ngIf",t.roles&&t.roles.length>0)}}function N(r,o){if(1&r&&(e.j41(0,"div",30),e.DNE(1,T,21,7,"div",31),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.users)}}function U(r,o){1&r&&e.nrm(0,"span",53)}function w(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",50)(1,"button",51),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.loadMoreResults())}),e.DNE(2,U,1,0,"span",52),e.EFF(3),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(),e.Y8G("disabled",t.isLoadingMore),e.R7$(),e.Y8G("ngIf",t.isLoadingMore),e.R7$(),e.SpI(" ",t.isLoadingMore?"Loading...":"Load More"," ")}}function P(r,o){if(1&r&&(e.j41(0,"div",16)(1,"div",17)(2,"h5",18),e.EFF(3),e.DNE(4,I,2,1,"span",19),e.k0s()(),e.j41(5,"div",4),e.DNE(6,E,6,0,"div",20)(7,M,6,0,"div",20)(8,N,2,1,"div",21)(9,w,4,3,"div",22),e.k0s()()),2&r){const t=e.XpG();e.R7$(3),e.SpI(' Search Results for "',t.searchQuery,'" '),e.R7$(),e.Y8G("ngIf",t.users.length>0),e.R7$(2),e.Y8G("ngIf",t.isSearching),e.R7$(),e.Y8G("ngIf",!t.isSearching&&0===t.users.length&&t.searchQuery),e.R7$(),e.Y8G("ngIf",!t.isSearching&&t.users.length>0),e.R7$(),e.Y8G("ngIf",!t.isSearching&&t.users.length>0&&t.hasMoreResults)}}function Y(r,o){1&r&&(e.j41(0,"div",16)(1,"div",54),e.nrm(2,"i",55),e.j41(3,"h4",29),e.EFF(4,"Find People"),e.k0s(),e.j41(5,"p",29),e.EFF(6,"Search for users by name, username, or email to connect with them"),e.k0s()()())}function O(r,o){1&r&&(e.j41(0,"div",82),e.EFF(1," Please select a reason for reporting "),e.k0s())}function X(r,o){1&r&&e.nrm(0,"span",53)}function D(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",56)(1,"div",57)(2,"div",58)(3,"div",59)(4,"h5",60),e.nrm(5,"i",61),e.EFF(6,"Report User "),e.k0s(),e.nrm(7,"button",62),e.k0s(),e.j41(8,"div",63)(9,"p",64),e.EFF(10," You are reporting "),e.j41(11,"strong"),e.EFF(12),e.k0s(),e.EFF(13),e.k0s(),e.j41(14,"form",65),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.submitReport())}),e.j41(15,"div",64)(16,"label",66),e.EFF(17,"Reason for Report"),e.k0s(),e.j41(18,"select",67)(19,"option",68),e.EFF(20,"Select a reason..."),e.k0s(),e.j41(21,"option",69),e.EFF(22,"Harassment"),e.k0s(),e.j41(23,"option",70),e.EFF(24,"Spam"),e.k0s(),e.j41(25,"option",71),e.EFF(26,"Inappropriate Content"),e.k0s(),e.j41(27,"option",72),e.EFF(28,"Fake Profile"),e.k0s(),e.j41(29,"option",73),e.EFF(30,"Other"),e.k0s()(),e.DNE(31,O,2,0,"div",74),e.k0s(),e.j41(32,"div",64)(33,"label",75),e.EFF(34,"Additional Details (Optional)"),e.k0s(),e.nrm(35,"textarea",76),e.k0s(),e.j41(36,"div",77),e.nrm(37,"i",78),e.j41(38,"small"),e.EFF(39,"Reports are reviewed by our moderation team. False reports may result in action against your account."),e.k0s()()()(),e.j41(40,"div",79)(41,"button",80),e.EFF(42,"Cancel"),e.k0s(),e.j41(43,"button",81),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.submitReport())}),e.DNE(44,X,1,0,"span",52),e.EFF(45),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(12),e.Lme("",null==t.selectedUser?null:t.selectedUser.firstName," ",null==t.selectedUser?null:t.selectedUser.lastName,""),e.R7$(),e.SpI(" (","@"+(null==t.selectedUser?null:t.selectedUser.userName),") "),e.R7$(),e.Y8G("formGroup",t.reportForm),e.R7$(4),e.AVh("is-invalid",t.isReportFieldInvalid("reason")),e.R7$(13),e.Y8G("ngIf",t.isReportFieldInvalid("reason")),e.R7$(12),e.Y8G("disabled",t.reportForm.invalid||t.isSubmittingReport),e.R7$(),e.Y8G("ngIf",t.isSubmittingReport),e.R7$(),e.SpI(" ",t.isSubmittingReport?"Submitting...":"Submit Report"," ")}}function V(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",83)(1,"div",84),e.nrm(2,"i",85),e.j41(3,"strong",86),e.EFF(4,"Success"),e.k0s(),e.j41(5,"button",87),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.successMessage="")}),e.k0s()(),e.j41(6,"div",88),e.EFF(7),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(7),e.JRh(t.successMessage)}}function L(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",83)(1,"div",89),e.nrm(2,"i",78),e.j41(3,"strong",86),e.EFF(4,"Error"),e.k0s(),e.j41(5,"button",87),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.errorMessage="")}),e.k0s()(),e.j41(6,"div",88),e.EFF(7),e.k0s()()}if(2&r){const t=e.XpG();e.R7$(7),e.JRh(t.errorMessage)}}let B=(()=>{class r{constructor(t,s,n,a){this.fb=t,this.userService=s,this.reportService=n,this.router=a,this.users=[],this.selectedUser=null,this.searchQuery="",this.isSearching=!1,this.isLoadingMore=!1,this.isSubmittingReport=!1,this.hasMoreResults=!1,this.currentPage=1,this.pageSize=10,this.successMessage="",this.errorMessage="",this.searchForm=this.fb.group({query:[""]}),this.reportForm=this.fb.group({reason:["",[c.k0.required]],description:[""]})}ngOnInit(){this.searchForm.get("query")?.valueChanges.pipe(function b(r,o=v.E){return(0,h.N)((t,s)=>{let n=null,a=null,d=null;const m=()=>{if(n){n.unsubscribe(),n=null;const l=a;a=null,s.next(l)}};function Q(){const l=d+r,g=o.now();if(g<l)return n=this.schedule(void 0,l-g),void s.add(n);m()}t.subscribe((0,f._)(s,l=>{a=l,d=o.now(),n||(n=o.schedule(Q,r),s.add(n))},()=>{m(),s.complete()},void 0,()=>{a=n=null}))})}(300),function F(r,o=_.D){return r=r??x,(0,h.N)((t,s)=>{let n,a=!0;t.subscribe((0,f._)(s,d=>{const m=o(d);(a||!r(n,m))&&(a=!1,n=m,s.next(d))}))})}(),(0,R.n)(t=>(this.searchQuery=t?.trim()||"",this.searchQuery.length>=2?(this.isSearching=!0,this.currentPage=1,this.userService.searchUsers(this.searchQuery,1,this.pageSize)):(this.users=[],(0,S.of)([]))))).subscribe({next:t=>{this.users=t,this.isSearching=!1,this.hasMoreResults=t.length===this.pageSize},error:t=>{this.isSearching=!1,this.errorMessage="Failed to search users. Please try again.",console.error("Search error:",t)}})}loadMoreResults(){if(this.searchQuery&&!this.isLoadingMore){this.isLoadingMore=!0;const t=this.currentPage+1;this.userService.searchUsers(this.searchQuery,t,this.pageSize).subscribe({next:s=>{this.users.push(...s),this.isLoadingMore=!1,this.hasMoreResults=s.length===this.pageSize,this.currentPage=t},error:s=>{this.isLoadingMore=!1,this.errorMessage="Failed to load more results. Please try again.",console.error("Load more error:",s)}})}}sendMessage(t){this.router.navigate(["/messages",t])}openReportModal(t){this.selectedUser=t,this.reportForm.reset(),new window.bootstrap.Modal(document.getElementById("reportModal")).show()}submitReport(){if(this.reportForm.valid&&this.selectedUser){this.isSubmittingReport=!0,this.errorMessage="";const t={reportedUserId:this.selectedUser.id,reason:this.reportForm.get("reason")?.value,description:this.reportForm.get("description")?.value||void 0};this.reportService.createReport(t).subscribe({next:()=>{this.isSubmittingReport=!1,this.successMessage="Report submitted successfully. Our team will review it.",window.bootstrap.Modal.getInstance(document.getElementById("reportModal"))?.hide(),this.selectedUser=null,this.reportForm.reset()},error:s=>{this.isSubmittingReport=!1,this.errorMessage=s.error?.message||"Failed to submit report. Please try again.",console.error("Report error:",s)}})}else this.markReportFormTouched()}getUserAvatar(t){return t.profileImagePath?this.getFullImageUrl(t.profileImagePath):"https://via.placeholder.com/60x60/3b82f6/ffffff?text="+(t.firstName?.charAt(0)||t.userName?.charAt(0)||"U")}getFullImageUrl(t){return t?t.startsWith("http")?t:`http://localhost:5120${t}`:""}isReportFieldInvalid(t){const s=this.reportForm.get(t);return!(!s||!s.invalid||!s.dirty&&!s.touched)}markReportFormTouched(){Object.keys(this.reportForm.controls).forEach(t=>{this.reportForm.get(t)?.markAsTouched()})}static{this.\u0275fac=function(s){return new(s||r)(e.rXU(c.ok),e.rXU(k.D),e.rXU(j.G),e.rXU(y.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-search"]],standalone:!0,features:[e.aNF],decls:19,vars:6,consts:[[1,"container","mt-4"],[1,"row","justify-content-center"],[1,"col-lg-8"],[1,"card","shadow-sm","mb-4"],[1,"card-body"],[1,"card-title","mb-3"],[1,"fas","fa-search","me-2"],[3,"formGroup"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text","formControlName","query","placeholder","Search by name, username, or email...",1,"form-control"],["class","card shadow-sm",4,"ngIf"],["class","modal fade","id","reportModal","tabindex","-1",4,"ngIf"],[1,"position-fixed","top-0","end-0","p-3",2,"z-index","1050"],["class","toast show","role","alert",4,"ngIf"],[1,"card","shadow-sm"],[1,"card-header"],[1,"mb-0"],["class","badge bg-primary ms-2",4,"ngIf"],["class","text-center py-4",4,"ngIf"],["class","row",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"badge","bg-primary","ms-2"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"fas","fa-user-slash","fa-3x","text-muted","mb-3"],[1,"text-muted"],[1,"row"],["class","col-md-6 mb-3",4,"ngFor","ngForOf"],[1,"col-md-6","mb-3"],[1,"card","user-card","h-100"],[1,"d-flex","align-items-center","mb-3"],["width","60","height","60","alt","User avatar",1,"rounded-circle","me-3",3,"src"],[1,"flex-grow-1"],[1,"card-title","mb-1"],[1,"text-muted","mb-1"],["class","card-text",4,"ngIf"],["class","d-flex flex-wrap gap-1 mb-3",4,"ngIf"],[1,"d-flex","gap-2"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-envelope","me-1"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"fas","fa-flag","me-1"],[1,"card-text"],[1,"d-flex","flex-wrap","gap-1","mb-3"],["class","badge bg-secondary rounded-pill",4,"ngFor","ngForOf"],[1,"badge","bg-secondary","rounded-pill"],[1,"text-center","mt-4"],[1,"btn","btn-outline-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"card-body","text-center","py-5"],[1,"fas","fa-users","fa-4x","text-muted","mb-3"],["id","reportModal","tabindex","-1",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-flag","me-2"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],[1,"mb-3"],[3,"ngSubmit","formGroup"],["for","reason",1,"form-label"],["id","reason","formControlName","reason",1,"form-select"],["value",""],["value","Harassment"],["value","Spam"],["value","Inappropriate Content"],["value","Fake Profile"],["value","Other"],["class","invalid-feedback",4,"ngIf"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","3","placeholder","Provide additional details about the issue...",1,"form-control"],[1,"alert","alert-warning"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-danger",3,"click","disabled"],[1,"invalid-feedback"],["role","alert",1,"toast","show"],[1,"toast-header","bg-success","text-white"],[1,"fas","fa-check-circle","me-2"],[1,"me-auto"],["type","button",1,"btn-close","btn-close-white",3,"click"],[1,"toast-body"],[1,"toast-header","bg-danger","text-white"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),e.nrm(6,"i",6),e.EFF(7,"Search Users "),e.k0s(),e.j41(8,"form",7)(9,"div",8)(10,"span",9),e.nrm(11,"i",10),e.k0s(),e.nrm(12,"input",11),e.k0s()()()(),e.DNE(13,P,10,6,"div",12)(14,Y,7,0,"div",12),e.k0s()()(),e.DNE(15,D,46,10,"div",13),e.j41(16,"div",14),e.DNE(17,V,8,1,"div",15)(18,L,8,1,"div",15),e.k0s()),2&s&&(e.R7$(8),e.Y8G("formGroup",n.searchForm),e.R7$(5),e.Y8G("ngIf",n.searchQuery),e.R7$(),e.Y8G("ngIf",!n.searchQuery),e.R7$(),e.Y8G("ngIf",n.selectedUser),e.R7$(2),e.Y8G("ngIf",n.successMessage),e.R7$(),e.Y8G("ngIf",n.errorMessage))},dependencies:[p.MD,p.Sq,p.bT,p.P9,c.X1,c.qT,c.xH,c.y7,c.me,c.wz,c.BC,c.cb,c.j4,c.JD],styles:[".user-card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease;border:none;box-shadow:0 2px 4px #0000001a}.user-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #00000026}.input-group-text[_ngcontent-%COMP%]{background-color:var(--light-bg);border-color:var(--border-color)}.badge[_ngcontent-%COMP%]{font-size:.75rem}.modal-content[_ngcontent-%COMP%]{border:none;border-radius:.75rem}.modal-header[_ngcontent-%COMP%]{border-bottom:1px solid var(--border-color)}.toast[_ngcontent-%COMP%]{min-width:300px}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:0 1rem}.user-card[_ngcontent-%COMP%]   .d-flex.gap-2[_ngcontent-%COMP%]{flex-direction:column}.user-card[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:.25rem}}"]})}}return r})()}}]);